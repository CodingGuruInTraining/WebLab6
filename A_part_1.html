<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Mark's To-Do List</title>
    <link rel="stylesheet" type="text/css" href="lab6styles.css">
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.1.1/jquery.min.js"></script>
</head>
<body>

<script>
    $(function() {
//        Adds initial elements to the body.
        $("body").append("<input type='text' id='inputbox'>" + "<br><br>");
        $("body").append("<button id='myButton'>Press Me</button>");
        $("body").append("<button id='clearButton'>Clear</button>");
        $("body").append("<ul id='myList'></ul>");
        $("body").append("<table id='myTable'><tr><th scope='col'>Item</th><th scope='col'>Date</th></tr></table>");



//var thedate = new Date();
//        console.log(Date());
//        console.log(thedate.getDate());
//        console.log(thedate.getMonth());
//        console.log(thedate.getFullYear());



        // Button click event listener.
        $("#myButton").click(function(){
            var input = $("#inputbox").val();
//            console.log("textbox reads: " + input);
            $("#myList").append("<li class='not_done'>" + input + "</li>");
        });

        // Clear click event listener.
        $("#clearButton").click(function(){

            var items = $(".complete");
            for (var x = 0; x < items.length; x++) {
//                console.log(x);
//                console.log(items[x]);                  // <li class='not_done complete'>blah</li>
//                console.log(items[x].date);             // undefined
//                console.log(items[x].innerHTML);        // success!
//                console.log(items[x].innerText);        // success!
//                console.log(items[x].toString());       // [object HTMLLIElement]
////                console.log(items[x].val());          // error
//                console.log(items[x].value);            // 0
//                console.log(items[x].text);             // undefined


//                var doneDate = items[x].data('date');
//var doneDate = "test " + x;
var rawDate = $(items[x]).data('date');            // works, but needs formatting!
//var doneDate = $.datepicker.formatDate('mm/dd/yyyy', rawDate);        // nope, need something else to run
//var doneDate = $(items[x]).data('date').toDateString;
//var doneDate = Date("mm/dd/yyyy");

var doneDate = (rawDate.getMonth()+1) + "/" + rawDate.getDate() + "/" + rawDate.getFullYear();

                $("#myTable").append(
                    "<tr><td>" + items[x].innerHTML + "</td><td>" + doneDate + "</td></tr>"
                );
            }



// FAIL 1
//            for (item in items) {
//                console.log(item + "<item  >> text " + item.innerHTML);
//            }
//            var doneDate = $(".complete").data('date');
//
//            $("#myTable").append(
//                "<tr><td>" + item + "</td><td>" + doneDate + "</td></tr>"
////                $(".complete")
//            );
//            $(".complete").remove();
        });

        // List click event listener.
        $("#myList").click(function(event){
            var whatEvent = event.target;
//            console.log("target text: " + whatEvent.innerHTML);
            $(whatEvent).toggleClass("complete");



            if (!$(whatEvent).data("date")) {
                $(whatEvent).data({"date": new Date()});         // works
                console.log("no data here");
            }
            else {

                console.log("data is:" + $(whatEvent).data('date'))}         // works

        });

    })
</script>

</body>
</html>

<!--helpers:-->
<!--http://stackoverflow.com/questions/5116929/get-clicked-li-from-ul-onclick-->
<!--http://stackoverflow.com/questions/3552461/how-to-format-a-javascript-date-->